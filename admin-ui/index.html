<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>THAYA Admin Console</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@500;700&family=IBM+Plex+Sans+Thai:wght@400;500;600&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="backdrop"></div>
  <div class="shell">
    <aside class="sidebar">
      <div class="brand">
        <h1>THAYA</h1>
        <p>Admin Console</p>
      </div>

      <nav class="menu">
        <button class="menu-item active" data-view="dashboard">Dashboard</button>
        <button class="menu-item" data-view="default">Default Instruction</button>
        <button class="menu-item" data-view="versions">Versions</button>
        <button class="menu-item" data-view="build">Build / Preview</button>
        <button class="menu-item" data-view="followups">Follow-up Rules</button>
        <button class="menu-item" data-view="images">Images</button>
      </nav>

      <div class="sidebar-footer">
        <button class="btn ghost" id="refreshAllBtn">Refresh All</button>
      </div>
    </aside>

    <main class="content">
      <header class="topbar">
        <div>
          <h2 id="viewTitle">Dashboard</h2>
          <p id="viewSubtitle">ภาพรวมระบบหลังบ้าน</p>
        </div>
        <div class="status-wrap">
          <span class="chip" id="defaultSourceChip">Source: -</span>
        </div>
      </header>

      <section class="view active" id="dashboardView">
        <div class="card-grid">
          <article class="card">
            <h3>Active Default</h3>
            <p class="big" id="activeDefaultName">-</p>
          </article>
          <article class="card">
            <h3>Active Version</h3>
            <p class="big" id="activeVersionName">-</p>
          </article>
          <article class="card">
            <h3>Total Versions</h3>
            <p class="big" id="totalVersionsCount">0</p>
          </article>
          <article class="card">
            <h3>Follow-up Rules</h3>
            <p class="big" id="followupCount">0</p>
          </article>
          <article class="card">
            <h3>Images</h3>
            <p class="big" id="imageCount">0</p>
          </article>
        </div>
      </section>

      <section class="view" id="defaultView">
        <div class="panel instruction-panel">
          <div class="panel-head">
            <h3>Default Instruction (DB)</h3>
            <div class="row-inline">
              <span class="chip subtle ok" id="defaultDirtyChip">บันทึกแล้ว</span>
              <button class="btn ghost" id="reloadDefaultBtn" type="button">โหลดใหม่</button>
              <button class="btn primary" id="saveDefaultBtn" type="button">บันทึก</button>
            </div>
          </div>
          <p class="hint-line">ลัดคีย์บอร์ด: <code>Ctrl/Cmd + S</code> เพื่อบันทึกฟอร์มที่กำลังเปิดอยู่</p>

          <div class="instruction-workbench">
            <article class="work-block">
              <h4>ข้อมูลหลัก</h4>
              <p class="work-note">กำหนด metadata และ source ของ default instruction</p>
              <div class="form-grid two">
                <label>
                  <span>ชื่อ</span>
                  <input id="defaultName" type="text" placeholder="Default Instruction">
                </label>
                <label>
                  <span>คำอธิบาย</span>
                  <input id="defaultDesc" type="text" placeholder="คำอธิบาย">
                </label>
              </div>

              <label>
                <span>Source</span>
                <select id="defaultSource">
                  <option value="manual">manual</option>
                  <option value="code">code</option>
                  <option value="google">google</option>
                </select>
              </label>
            </article>

            <article class="work-block">
              <h4>Google Doc Content</h4>
              <p class="work-note">ข้อความหลักจากเอกสาร สามารถแก้ไขตรงนี้ก่อนบันทึกลงฐานข้อมูล</p>
              <label>
                <span>Google Doc Content</span>
                <textarea id="defaultGoogleDoc" rows="10"></textarea>
              </label>
            </article>

            <article class="work-block">
              <div class="work-head-row">
                <h4>Sheet Data Composer</h4>
                <span class="chip subtle" id="defaultSheetStats">0 คอลัมน์ • 0 แถว</span>
              </div>
              <p class="work-note">แก้ไขผ่านตารางหรือ JSON ได้ โดยหลังบ้านเก็บเป็น JSON array เสมอ</p>
              <div class="sheet-editor" data-editor="default">
                <div class="sheet-toolbar">
                  <div class="segmented">
                    <button class="seg-btn active" id="defaultSheetModeTable" type="button">Table</button>
                    <button class="seg-btn" id="defaultSheetModeJson" type="button">JSON</button>
                  </div>
                  <div class="row-inline wrap">
                    <button class="btn ghost small" id="defaultSheetAddColumn" type="button">+ คอลัมน์</button>
                    <button class="btn ghost small" id="defaultSheetAddRow" type="button">+ แถว</button>
                    <button class="btn ghost small" id="defaultSheetPasteTable" type="button">วางจากคลิปบอร์ด</button>
                    <button class="btn ghost small" id="defaultSheetSyncToJson" type="button">อัปเดต JSON</button>
                    <button class="btn ghost small" id="defaultSheetSyncFromJson" type="button">ใช้ JSON นี้</button>
                    <button class="btn ghost small" id="defaultSheetExportJson" type="button">Export JSON</button>
                    <button class="btn ghost small danger-text" id="defaultSheetClear" type="button">ล้างตาราง</button>
                  </div>
                </div>

                <div class="sheet-mode-panel active" id="defaultSheetTablePanel">
                  <p class="sheet-empty" id="defaultSheetEmpty">ยังไม่มีคอลัมน์ เริ่มด้วยการเพิ่มคอลัมน์ก่อนสร้างแถวข้อมูล</p>
                  <div class="table-wrap">
                    <table class="sheet-table">
                      <thead id="defaultSheetHead"></thead>
                      <tbody id="defaultSheetBody"></tbody>
                    </table>
                  </div>
                </div>

                <div class="sheet-mode-panel" id="defaultSheetJsonPanel">
                  <label>
                    <span>Sheet Data JSON</span>
                    <textarea id="defaultSheetJson" class="mono" rows="12"></textarea>
                  </label>
                </div>
              </div>
            </article>

            <article class="work-block">
              <h4>Static Instructions</h4>
              <p class="work-note">ข้อกำหนดเสริมที่จะถูกต่อท้าย instruction ทุกครั้ง</p>
              <label>
                <span>Static Instructions</span>
                <textarea id="defaultStatic" rows="8"></textarea>
              </label>
            </article>
          </div>
        </div>
      </section>

      <section class="view" id="versionsView">
        <div class="panel">
          <div class="panel-head">
            <h3>เวอร์ชันทั้งหมด</h3>
            <div class="row-inline">
              <input id="versionsSearch" type="search" placeholder="ค้นหาเวอร์ชัน...">
              <button class="btn ghost" id="importVersionBtn" type="button">Import JSON</button>
            </div>
          </div>

          <div class="table-wrap">
            <table>
              <thead>
                <tr>
                  <th>ชื่อ</th>
                  <th>สถานะ</th>
                  <th>อัปเดตล่าสุด</th>
                  <th>จัดการ</th>
                </tr>
              </thead>
              <tbody id="versionsTableBody"></tbody>
            </table>
          </div>
        </div>

        <div class="panel instruction-panel">
          <div class="panel-head">
            <h3>แก้ไข/สร้างเวอร์ชัน</h3>
            <div class="row-inline">
              <span class="chip subtle ok" id="versionDirtyChip">บันทึกแล้ว</span>
              <button class="btn ghost" id="newVersionBtn" type="button">สร้างใหม่</button>
              <button class="btn ghost" id="createFromDefaultBtn" type="button">ใช้ Default เป็นต้นแบบ</button>
              <button class="btn primary" id="saveVersionBtn" type="button">บันทึกเวอร์ชัน</button>
            </div>
          </div>
          <p class="hint-line">ลัดคีย์บอร์ด: <code>Ctrl/Cmd + S</code> เพื่อบันทึกเวอร์ชันปัจจุบัน</p>

          <input id="versionId" type="hidden">
          <div class="instruction-workbench">
            <article class="work-block">
              <h4>ข้อมูลเวอร์ชัน</h4>
              <p class="work-note">เลือกเวอร์ชันจากตารางด้านบนเพื่อแก้ไข หรือสร้างใหม่ได้ทันที</p>
              <div class="form-grid two">
                <label>
                  <span>ชื่อเวอร์ชัน</span>
                  <input id="versionName" type="text">
                </label>
                <label>
                  <span>คำอธิบาย</span>
                  <input id="versionDesc" type="text">
                </label>
              </div>
            </article>

            <article class="work-block">
              <h4>Google Doc Content</h4>
              <label>
                <span>Google Doc Content</span>
                <textarea id="versionGoogleDoc" rows="8"></textarea>
              </label>
            </article>

            <article class="work-block">
              <div class="work-head-row">
                <h4>Sheet Data Composer</h4>
                <span class="chip subtle" id="versionSheetStats">0 คอลัมน์ • 0 แถว</span>
              </div>
              <p class="work-note">รองรับทั้ง Table mode และ JSON mode โดยข้อมูลที่บันทึกจะเป็น JSON เดียวกัน</p>
              <div class="sheet-editor" data-editor="version">
                <div class="sheet-toolbar">
                  <div class="segmented">
                    <button class="seg-btn active" id="versionSheetModeTable" type="button">Table</button>
                    <button class="seg-btn" id="versionSheetModeJson" type="button">JSON</button>
                  </div>
                  <div class="row-inline wrap">
                    <button class="btn ghost small" id="versionSheetAddColumn" type="button">+ คอลัมน์</button>
                    <button class="btn ghost small" id="versionSheetAddRow" type="button">+ แถว</button>
                    <button class="btn ghost small" id="versionSheetPasteTable" type="button">วางจากคลิปบอร์ด</button>
                    <button class="btn ghost small" id="versionSheetSyncToJson" type="button">อัปเดต JSON</button>
                    <button class="btn ghost small" id="versionSheetSyncFromJson" type="button">ใช้ JSON นี้</button>
                    <button class="btn ghost small" id="versionSheetExportJson" type="button">Export JSON</button>
                    <button class="btn ghost small danger-text" id="versionSheetClear" type="button">ล้างตาราง</button>
                  </div>
                </div>

                <div class="sheet-mode-panel active" id="versionSheetTablePanel">
                  <p class="sheet-empty" id="versionSheetEmpty">ยังไม่มีคอลัมน์ เริ่มด้วยการเพิ่มคอลัมน์ก่อนสร้างแถวข้อมูล</p>
                  <div class="table-wrap">
                    <table class="sheet-table">
                      <thead id="versionSheetHead"></thead>
                      <tbody id="versionSheetBody"></tbody>
                    </table>
                  </div>
                </div>

                <div class="sheet-mode-panel" id="versionSheetJsonPanel">
                  <label>
                    <span>Sheet Data JSON</span>
                    <textarea id="versionSheetJson" class="mono" rows="10"></textarea>
                  </label>
                </div>
              </div>
            </article>

            <article class="work-block">
              <h4>Static Instructions</h4>
              <label>
                <span>Static Instructions</span>
                <textarea id="versionStatic" rows="6"></textarea>
              </label>
            </article>
          </div>
        </div>
      </section>

      <section class="view" id="buildView">
        <div class="panel">
          <div class="panel-head">
            <h3>Build / Preview</h3>
            <div class="row-inline">
              <select id="buildSource"></select>
              <select id="buildFormat">
                <option value="pretty">Pretty</option>
                <option value="compact">Compact</option>
              </select>
              <button class="btn primary" id="buildBtn">Build</button>
            </div>
          </div>

          <div class="stats-line">
            <span>Tokens: <strong id="buildTokens">-</strong></span>
            <span>Cost est.: <strong id="buildCost">-</strong></span>
          </div>
          <pre id="buildOutput" class="output">คลิก Build เพื่อสร้างผลลัพธ์</pre>
        </div>
      </section>

      <section class="view" id="followupsView">
        <div class="panel">
          <div class="panel-head">
            <h3>Follow-up Rules</h3>
            <div class="row-inline">
              <button class="btn ghost" id="addFollowupBtn">เพิ่มแถว</button>
              <button class="btn primary" id="saveFollowupsBtn">บันทึก</button>
            </div>
          </div>

          <div class="table-wrap">
            <table>
              <thead>
                <tr>
                  <th>Step</th>
                  <th>Delay (minutes)</th>
                  <th>Message</th>
                  <th>Active</th>
                  <th></th>
                </tr>
              </thead>
              <tbody id="followupTableBody"></tbody>
            </table>
          </div>
        </div>
      </section>

      <section class="view" id="imagesView">
        <div class="panel">
          <div class="panel-head">
            <h3>Image Manager</h3>
            <button class="btn ghost" id="reloadImagesBtn">โหลดรูปใหม่</button>
          </div>

          <div class="form-grid four">
            <label>
              <span>ไฟล์รูป</span>
              <input id="imageFile" type="file" accept="image/*">
            </label>
            <label>
              <span>Key</span>
              <input id="imageKey" type="text" placeholder="product_1">
            </label>
            <label>
              <span>Name</span>
              <input id="imageName" type="text" placeholder="รูปสินค้า 1">
            </label>
            <label>
              <span>Category</span>
              <input id="imageCategory" type="text" placeholder="product">
            </label>
          </div>

          <button class="btn primary" id="uploadImageBtn">อัปโหลดรูป</button>
        </div>

        <div class="image-grid" id="imageGrid"></div>
      </section>
    </main>
  </div>

  <div class="toast-stack" id="toastStack"></div>
  <script src="app.js"></script>
</body>
</html>
